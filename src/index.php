<?php

require_once 'spyc.php';

$data = array();
if($files = glob('*.yaml')) {
	foreach($files as $filename) {
		$data[basename($filename, '.yaml')] = Spyc::YAMLLoad($filename);
	}
}
else die("no sources");

$x = array_keys($data);
$y = array(
	'xep-0001',
	'xep-0002',
	'xep-0003',
	'xep-0004',
	'xep-0005',
	'xep-0006',
	'xep-0007',
	'xep-0008',
	'xep-0009',
	'xep-0010',
	'xep-0011',
	'xep-0012',
	'xep-0013',
	'xep-0014',
	'xep-0015',
	'xep-0016',
	'xep-0017',
	'xep-0018',
	'xep-0019',
	'xep-0020',
	'xep-0021',
	'xep-0022',
	'xep-0023',
	'xep-0024',
	'xep-0025',
	'xep-0026',
	'xep-0027',
	'xep-0028',
	'xep-0029',
	'xep-0030',
	'xep-0031',
	'xep-0032',
	'xep-0033',
	'xep-0034',
	'xep-0035',
	'xep-0036',
	'xep-0037',
	'xep-0038',
	'xep-0039',
	'xep-0040',
	'xep-0041',
	'xep-0042',
	'xep-0043',
	'xep-0044',
	'xep-0045',
	'xep-0046',
	'xep-0047',
	'xep-0048',
	'xep-0049',
	'xep-0050',
	'xep-0051',
	'xep-0052',
	'xep-0053',
	'xep-0054',
	'xep-0055',
	'xep-0056',
	'xep-0057',
	'xep-0058',
	'xep-0059',
	'xep-0060',
	'xep-0061',
	'xep-0062',
	'xep-0063',
	'xep-0064',
	'xep-0065',
	'xep-0066',
	'xep-0067',
	'xep-0068',
	'xep-0069',
	'xep-0070',
	'xep-0071',
	'xep-0072',
	'xep-0073',
	'xep-0074',
	'xep-0075',
	'xep-0076',
	'xep-0077',
	'xep-0078',
	'xep-0079',
	'xep-0080',
	'xep-0081',
	'xep-0082',
	'xep-0083',
	'xep-0084',
	'xep-0085',
	'xep-0086',
	'xep-0087',
	'xep-0088',
	'xep-0089',
	'xep-0090',
	'xep-0091',
	'xep-0092',
	'xep-0093',
	'xep-0094',
	'xep-0095',
	'xep-0096',
	'xep-0097',
	'xep-0098',
	'xep-0099',
	'xep-0100',
	'xep-0101',
	'xep-0102',
	'xep-0103',
	'xep-0104',
	'xep-0105',
	'xep-0106',
	'xep-0107',
	'xep-0108',
	'xep-0109',
	'xep-0110',
	'xep-0111',
	'xep-0112',
	'xep-0113',
	'xep-0114',
	'xep-0115',
	'xep-0116',
	'xep-0117',
	'xep-0118',
	'xep-0119',
	'xep-0120',
	'xep-0121',
	'xep-0122',
	'xep-0123',
	'xep-0124',
	'xep-0125',
	'xep-0126',
	'xep-0127',
	'xep-0128',
	'xep-0129',
	'xep-0130',
	'xep-0131',
	'xep-0132',
	'xep-0133',
	'xep-0134',
	'xep-0135',
	'xep-0136',
	'xep-0137',
	'xep-0138',
	'xep-0139',
	'xep-0140',
	'xep-0141',
	'xep-0142',
	'xep-0143',
	'xep-0144',
	'xep-0145',
	'xep-0146',
	'xep-0147',
	'xep-0148',
	'xep-0149',
	'xep-0150',
	'xep-0151',
	'xep-0152',
	'xep-0153',
	'xep-0154',
	'xep-0155',
	'xep-0156',
	'xep-0157',
	'xep-0158',
	'xep-0159',
	'xep-0160',
	'xep-0161',
	'xep-0162',
	'xep-0163',
	'xep-0164',
	'xep-0165',
	'xep-0166',
	'xep-0167',
	'xep-0168',
	'xep-0169',
	'xep-0170',
	'xep-0171',
	'xep-0172',
	'xep-0173',
	'xep-0174',
	'xep-0175',
	'xep-0176',
	'xep-0177',
	'xep-0178',
	'xep-0179',
	'xep-0180',
	'xep-0181',
	'xep-0182',
	'xep-0183',
	'xep-0184',
	'xep-0185',
	'xep-0186',
	'xep-0187',
	'xep-0188',
	'xep-0189',
	'xep-0190',
	'xep-0191',
	'xep-0192',
	'xep-0193',
	'xep-0194',
	'xep-0195',
	'xep-0196',
	'xep-0197',
	'xep-0198',
	'xep-0199',
	'xep-0200',
	'xep-0201',
	'xep-0202',
	'xep-0203',
	'xep-0204',
	'xep-0205',
	'xep-0206',
	'xep-0207',
	'xep-0208',
	'xep-0209',
	'xep-0210',
	'xep-0211',
	'xep-0212',
	'xep-0213',
	'xep-0214',
	'xep-0215',
	'xep-0216',
	'xep-0217',
	'xep-0218',
	'xep-0219',
	'xep-0220',
	'xep-0221',
	'xep-0222',
	'xep-0223',
	'xep-0224',
	'xep-0225',
	'xep-0226',
	'xep-0227',
	'xep-0228',
	'xep-0229',
	'xep-0230',
	'xep-0231',
	'xep-0232',
	'xep-0233',
	'xep-0234',
	'xep-0235',
	'xep-0236',
	'xep-0237',
	'xep-0238',
	'xep-0239',
	'xep-0240',
	'xep-0241',
	'xep-0242',
	'xep-0243',
	'xep-0244',
	'xep-0245',
	'xep-0246',
	'xep-0247',
	'xep-0248',
	'xep-0249',
	'xep-0250',
	'xep-0251',
	'xep-0252',
	'xep-0253',
	'xep-0254',
	'xep-0255',
	'xep-0256',
	'xep-0257',
	'xep-0258',
	'xep-0259',
	'xep-0260',
	'xep-0261',
	'xep-0262',
	'xep-0263',
	'xep-0264',
	'xep-0265',
	'xep-0266',
	'xep-0267',
	'xep-0268',
	'xep-0269',
	'xep-0270',
	'xep-0271',
	'xep-0272',
	'xep-0273',
	'xep-0274',
	'xep-0275',
	'xep-0276',
	'xep-0277',
	'xep-0280',
);

foreach($data as $cols) {
	$y = array_merge($y, array_keys($cols));
}
$y = array_unique($y);
sort($y);

echo "<h1>Probably inaccurate feature comparison table</h1>";
echo "<table>\n";
echo "<thead>\n";
echo "<tr>\n";
echo "<th>feature\server</th>\n";
foreach($x as $row) {
	echo "<th>$row</th>\n";
}
echo "</tr>\n";
echo "</thead>\n";
echo "<tbody>\n";
foreach($y as $col) {
	echo "<tr>\n";
	echo "<th>$col</th>\n";
	foreach($x as $row) {
		if(isset($data[$row][$col])) {
			$cell = $data[$row][$col];
			$comment = "";
			if(is_array($cell)) {
				list($ver, $comment) = $cell;
				$cell = $ver;
			}
			printf("<td bgcolor='green'>%s $comment</td>\n", (is_bool($cell)?($cell?"yes":"no"):$cell));
		}
		else
			echo "<td bgcolor='red'>no</td>\n";
	}
	echo "</tr>\n";
}
echo "</tbody>\n";
echo "</table>\n";

